# Generated by Django 5.1.3 on 2025-09-12 19:57

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('gradvy_auth', '0006_authevent_usersession'),
    ]

    operations = [
        migrations.CreateModel(
            name='SocialProvider',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(choices=[('google', 'Google'), ('facebook', 'Facebook'), ('github', 'GitHub'), ('linkedin', 'LinkedIn'), ('twitter', 'Twitter/X'), ('microsoft', 'Microsoft'), ('apple', 'Apple'), ('discord', 'Discord'), ('slack', 'Slack')], max_length=50, unique=True)),
                ('display_name', models.CharField(max_length=100)),
                ('is_active', models.BooleanField(default=True)),
                ('client_id', models.CharField(max_length=255)),
                ('client_secret', models.CharField(max_length=255)),
                ('authorize_url', models.URLField()),
                ('token_url', models.URLField()),
                ('user_info_url', models.URLField()),
                ('default_scopes', models.JSONField(default=list, help_text='Default OAuth scopes to request')),
                ('optional_scopes', models.JSONField(default=list, help_text='Optional scopes for rich data')),
                ('field_mappings', models.JSONField(default=dict, help_text='Map provider fields to our user fields')),
                ('auto_register', models.BooleanField(default=True, help_text='Automatically register new users')),
                ('require_email_verification', models.BooleanField(default=False)),
                ('collect_extended_profile', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Social Provider',
                'verbose_name_plural': 'Social Providers',
                'db_table': 'auth_social_provider',
            },
        ),
        migrations.CreateModel(
            name='SocialAccount',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('access_token', models.TextField(help_text='OAuth access token')),
                ('refresh_token', models.TextField(blank=True, help_text='OAuth refresh token')),
                ('token_expires_at', models.DateTimeField(blank=True, null=True)),
                ('provider_user_id', models.CharField(help_text="User ID on the provider's platform", max_length=255)),
                ('username', models.CharField(blank=True, max_length=255)),
                ('email', models.EmailField(blank=True, max_length=254)),
                ('profile_data', models.JSONField(default=dict, help_text='Complete profile data from provider')),
                ('raw_profile_data', models.JSONField(default=dict, help_text='Raw unprocessed profile data')),
                ('scopes_granted', models.JSONField(default=list, help_text='OAuth scopes granted by user')),
                ('connection_method', models.CharField(choices=[('oauth', 'OAuth Authorization'), ('api_key', 'API Key'), ('webhook', 'Webhook')], default='oauth', max_length=50)),
                ('is_active', models.BooleanField(default=True)),
                ('last_sync', models.DateTimeField(blank=True, null=True)),
                ('sync_frequency', models.CharField(choices=[('real_time', 'Real Time'), ('hourly', 'Hourly'), ('daily', 'Daily'), ('weekly', 'Weekly'), ('manual', 'Manual Only')], default='daily', max_length=20)),
                ('data_collection_consent', models.BooleanField(default=True)),
                ('public_profile_allowed', models.BooleanField(default=False)),
                ('analytics_consent', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='social_accounts', to=settings.AUTH_USER_MODEL)),
                ('provider', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='gradvy_auth.socialprovider')),
            ],
            options={
                'verbose_name': 'Social Account',
                'verbose_name_plural': 'Social Accounts',
                'db_table': 'auth_social_account',
            },
        ),
        migrations.CreateModel(
            name='SocialWebhook',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('webhook_url', models.URLField(help_text='URL endpoint for webhook')),
                ('webhook_secret', models.CharField(help_text='Secret for webhook verification', max_length=255)),
                ('subscribed_events', models.JSONField(default=list, help_text='List of events to subscribe to')),
                ('is_active', models.BooleanField(default=True)),
                ('retry_attempts', models.PositiveIntegerField(default=3)),
                ('timeout_seconds', models.PositiveIntegerField(default=30)),
                ('events_received', models.PositiveIntegerField(default=0)),
                ('last_event_received', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('provider', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='gradvy_auth.socialprovider')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='social_webhooks', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Social Webhook',
                'verbose_name_plural': 'Social Webhooks',
                'db_table': 'auth_social_webhook',
            },
        ),
        migrations.CreateModel(
            name='SocialProfileEnrichment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('enrichment_type', models.CharField(choices=[('demographic', 'Demographic Information'), ('interests', 'Interests and Hobbies'), ('skills', 'Skills and Expertise'), ('education', 'Educational Background'), ('employment', 'Employment History'), ('location', 'Location History'), ('network', 'Social Network Analysis'), ('activity', 'Activity Patterns'), ('content', 'Content Preferences'), ('influence', 'Social Influence Metrics')], max_length=50)),
                ('confidence_score', models.FloatField(default=0.0, help_text='Confidence in data accuracy (0-1)')),
                ('enrichment_data', models.JSONField(default=dict)),
                ('source_data', models.JSONField(default=dict, help_text='Original source data used for enrichment')),
                ('extraction_method', models.CharField(help_text='Method used to extract this data', max_length=100)),
                ('processing_version', models.CharField(default='1.0', max_length=20)),
                ('is_validated', models.BooleanField(default=False)),
                ('validated_by', models.CharField(blank=True, max_length=100)),
                ('validation_notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('social_account', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='gradvy_auth.socialaccount')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='profile_enrichments', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Social Profile Enrichment',
                'verbose_name_plural': 'Social Profile Enrichments',
                'db_table': 'auth_social_profile_enrichment',
                'indexes': [models.Index(fields=['user', 'enrichment_type'], name='auth_social_user_id_0e1296_idx'), models.Index(fields=['confidence_score'], name='auth_social_confide_caba68_idx'), models.Index(fields=['is_validated'], name='auth_social_is_vali_4fc881_idx')],
                'unique_together': {('social_account', 'enrichment_type')},
            },
        ),
        migrations.CreateModel(
            name='SocialDataCollection',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('collection_type', models.CharField(choices=[('profile', 'Basic Profile'), ('contacts', 'Contacts/Friends'), ('posts', 'Posts/Tweets'), ('activity', 'Activity/Interactions'), ('preferences', 'User Preferences'), ('location', 'Location Data'), ('professional', 'Professional Information'), ('educational', 'Educational Background'), ('interests', 'Interests/Hobbies'), ('behavioral', 'Behavioral Patterns')], max_length=50)),
                ('purpose', models.TextField(help_text='Purpose of data collection')),
                ('consent_status', models.CharField(choices=[('pending', 'Pending'), ('granted', 'Granted'), ('denied', 'Denied'), ('revoked', 'Revoked'), ('expired', 'Expired')], default='pending', max_length=20)),
                ('consent_granted_at', models.DateTimeField(blank=True, null=True)),
                ('consent_expires_at', models.DateTimeField(blank=True, null=True)),
                ('consent_revoked_at', models.DateTimeField(blank=True, null=True)),
                ('required_scopes', models.JSONField(default=list)),
                ('optional_scopes', models.JSONField(default=list)),
                ('data_retention_days', models.PositiveIntegerField(default=365)),
                ('last_collection', models.DateTimeField(blank=True, null=True)),
                ('collection_count', models.PositiveIntegerField(default=0)),
                ('data_points_collected', models.PositiveIntegerField(default=0)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='social_data_collections', to=settings.AUTH_USER_MODEL)),
                ('provider', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='gradvy_auth.socialprovider')),
            ],
            options={
                'verbose_name': 'Social Data Collection',
                'verbose_name_plural': 'Social Data Collections',
                'db_table': 'auth_social_data_collection',
                'indexes': [models.Index(fields=['consent_status'], name='auth_social_consent_cd4da7_idx'), models.Index(fields=['consent_expires_at'], name='auth_social_consent_f36915_idx'), models.Index(fields=['last_collection'], name='auth_social_last_co_3ced4e_idx')],
                'unique_together': {('user', 'provider', 'collection_type')},
            },
        ),
        migrations.CreateModel(
            name='SocialAuthEvent',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('event_type', models.CharField(choices=[('connect', 'Account Connected'), ('disconnect', 'Account Disconnected'), ('sync', 'Profile Data Sync'), ('refresh_token', 'Token Refresh'), ('error', 'Authentication Error'), ('consent_granted', 'Data Consent Granted'), ('consent_revoked', 'Data Consent Revoked'), ('scope_updated', 'OAuth Scopes Updated')], max_length=50)),
                ('success', models.BooleanField(default=True)),
                ('details', models.JSONField(default=dict)),
                ('error_message', models.TextField(blank=True)),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('user_agent', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('social_account', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='gradvy_auth.socialaccount')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='social_auth_events', to=settings.AUTH_USER_MODEL)),
                ('provider', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='gradvy_auth.socialprovider')),
            ],
            options={
                'verbose_name': 'Social Auth Event',
                'verbose_name_plural': 'Social Auth Events',
                'db_table': 'auth_social_event',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['user', 'event_type'], name='auth_social_user_id_52778c_idx'), models.Index(fields=['provider', 'created_at'], name='auth_social_provide_67b299_idx'), models.Index(fields=['success'], name='auth_social_success_560bbe_idx')],
            },
        ),
        migrations.AddIndex(
            model_name='socialaccount',
            index=models.Index(fields=['user', 'provider'], name='auth_social_user_id_c2330c_idx'),
        ),
        migrations.AddIndex(
            model_name='socialaccount',
            index=models.Index(fields=['provider_user_id'], name='auth_social_provide_0ed549_idx'),
        ),
        migrations.AddIndex(
            model_name='socialaccount',
            index=models.Index(fields=['last_sync'], name='auth_social_last_sy_8af443_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='socialaccount',
            unique_together={('provider', 'provider_user_id')},
        ),
        migrations.AlterUniqueTogether(
            name='socialwebhook',
            unique_together={('provider', 'user')},
        ),
    ]
